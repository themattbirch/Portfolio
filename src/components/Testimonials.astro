---
interface Testimonial {
  name: string;
  business: string;
  quote: string;
  photoUrl: string;
}

interface Props {
  testimonials?: Testimonial[];
}

const testimonials: Testimonial[] = [
  {
    name: "Jane Doe",
    business: "Doe Innovations",
    quote:
      "Truly exceptional service and project outcomes that exceeded our expectations.",
    photoUrl: "/images/headshot-tan-tee-2.jpg",
  },
  {
    name: "John Smith",
    business: "Smith Consulting",
    quote:
      "A professional approach and great results. Highly recommended web developer.",
    photoUrl: "/images/headshot-tan-tee-2.jpg",
  },
];
---

<div class="swiper-container relative">
  <div class="swiper-wrapper">
    {
      testimonials && testimonials.length > 0 ? (
        testimonials.map((testimonial) => (
          <div class="swiper-slide">
            <div class="testimonial-card rounded-lg p-6 shadow-lg text-gray-800 dark:text-white relative overflow-hidden max-w-xs md:max-w-sm lg:max-w-md mx-auto">
              <div class="testimonial-photo-wrapper">
                <img
                  src={testimonial.photoUrl}
                  alt={`Headshot of ${testimonial.name}`}
                  class="testimonial-photo w-24 h-24 rounded-full object-cover mx-auto shadow-lg mb-4"
                  loading="lazy"
                />
              </div>
              <div class="text-center">
                <p class="text-2xl font-semibold">{testimonial.name}</p>
                <p class="text-sm text-gray-600 dark:text-gray-400">
                  {testimonial.business}
                </p>
                <p class="text-gray-700 dark:text-gray-300 italic mt-4">
                  "{testimonial.quote}"
                </p>
              </div>
            </div>
          </div>
        ))
      ) : (
        <p>No testimonials available.</p>
      )
    }
  </div>

  <div class="swiper-button-prev"></div>
  <div class="swiper-button-next"></div>
  <div class="swiper-pagination"></div>
</div>

<script>
  import Swiper from "swiper";
  import { Navigation, Pagination, Autoplay } from "swiper/modules";
  import "swiper/css";
  import "swiper/css/navigation";
  import "swiper/css/pagination";

  function initSwiper() {
    new Swiper(".swiper-container", {
      modules: [Navigation, Pagination, Autoplay],
      loop: true,
      slidesPerView: 1,
      spaceBetween: 30,
      autoplay: {
        delay: 5000,
        disableOnInteraction: false,
      },
      pagination: {
        el: ".swiper-pagination",
        clickable: true,
      },
      navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
      },
    });
  }

  // Initialize Swiper on page load
  document.addEventListener("DOMContentLoaded", initSwiper);

  // Re-initialize Swiper when the page content is updated (for Astro view transitions)
  document.addEventListener("astro:page-load", initSwiper);
</script>

<style>
  .swiper-container {
    width: 100%;
    height: auto;
    padding: 2rem 0;
    overflow: hidden;
  }

  .swiper-slide {
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .hero-wrapper {
    margin-top: -4rem;
    margin-bottom: -4rem;
  }

  .hero {
    position: relative;
    z-index: 1;
  }

  .hero-text {
    color: #1a202c;
  }

  :global(.dark) .hero-text {
    color: #ffffff;
  }

  .hero > div {
    position: relative;
    z-index: 2;
  }

  .testimonials-section {
    position: relative;
    z-index: 1;
    background-color: #1e293b; /* Dark grey background (Tailwind's gray-800) for light mode */
  }

  :global(.dark) .testimonials-section {
    background-color: transparent; /* Transparent background for dark mode */
  }
</style>
